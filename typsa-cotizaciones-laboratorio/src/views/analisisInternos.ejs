<!DOCTYPE html>
<html lang="es">
<head>
  <%- include('./partials/meta', { titulo: 'An√°lisis Internos' }) %>
</head>
<body>
  <%- include('./partials/navbar', { page: '/analisisInternos', logged }) %>

  <div class="container mt-5">
    <h2>üß¨ An√°lisis Internos </h2>


    <input type="text" id="buscador" class="form-control mb-3" placeholder="Buscar an√°lisis por nombre...">

    <table class="table table-hover table-sm align-middle">
      <thead class="table-light">
        <tr>
          <th>Ensayo</th>
          <th>Nombre</th>
          <th>Secci√≥n</th>
          <th>Clave</th>
          <th>M√©todo Anal√≠tico</th>
          <th>T√©cnica</th>
          <th>Procedimiento</th>
          <th>Validado</th>
          <th>Acreditado</th>
          <th>Tasa</th>
          <th>Coste</th>
          <th>Subcontratado</th>
        </tr>
      </thead>
      <tbody id="tablaAnalisis">
        <% analisis.forEach(a => { %>
          <tr>
            <td><%= a.Ensayo %></td>
            <td><%= a.Nombre %></td>
            <td><%= a.Seccion %></td>
            <td><%= a.Clave_Abreviada %></td>
            <td><%= a.Metodo_Analitico %></td>
            <td><%= a.Tecnica %></td>
            <td><%= a.Procedimiento %></td>
            <td><%= a.Metodo_Validado ? '‚úîÔ∏è' : '' %></td>
            <td><%= a.Acreditada ? '‚úîÔ∏è' : '' %></td>
            <td><%= a.Tasa || '' %></td>
            <td><%= a.Coste_Estimado || '' %></td>
            <td><%= a.Subcontratado ? 'S√≠' : 'No' %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>

  <script>
    // üîç Buscador simple por nombre
    document.getElementById('buscador').addEventListener('input', function () {
      const filtro = this.value.toLowerCase();
      document.querySelectorAll('#tablaAnalisis tr').forEach(fila => {
        const texto = fila.textContent.toLowerCase();
        fila.style.display = texto.includes(filtro) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
